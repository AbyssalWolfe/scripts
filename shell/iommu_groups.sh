#!/bin/sh

######################################################################################################
#                                                                                                    #
# ██╗ ██████╗ ███╗   ███╗███╗   ███╗██╗   ██╗     ██████╗ ██████╗  ██████╗ ██╗   ██╗██████╗ ███████╗ #
# ██║██╔═══██╗████╗ ████║████╗ ████║██║   ██║    ██╔════╝ ██╔══██╗██╔═══██╗██║   ██║██╔══██╗██╔════╝ #
# ██║██║   ██║██╔████╔██║██╔████╔██║██║   ██║    ██║  ███╗██████╔╝██║   ██║██║   ██║██████╔╝███████╗ #
# ██║██║   ██║██║╚██╔╝██║██║╚██╔╝██║██║   ██║    ██║   ██║██╔══██╗██║   ██║██║   ██║██╔═══╝ ╚════██║ #
# ██║╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║╚██████╔╝    ╚██████╔╝██║  ██║╚██████╔╝╚██████╔╝██║     ███████║ #
# ╚═╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝ ╚═════╝      ╚═════╝ ╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝     ╚══════╝ #
#                                                                                                    #
######################################################################################################

for g in $(find /sys/kernel/iommu_groups/* -maxdepth 0 -type d | sort -V); do
	echo "IOMMU Group ${g##*/}:"
	for d in "$g"/devices/*; do
		printf "\t%s" "$(lspci -nns "${d##*/}")"
	done
done
unset g d
